<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Yamdut Live Trip Map</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
html, body, #map { height: 100%; margin: 0; padding: 0; }
#status {
    position: absolute; top: 10px; left: 50%; transform: translateX(-50%);
    background: white; padding: 6px 12px; border-radius: 6px;
    font-family: Arial, sans-serif; font-size: 13px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.3); z-index: 999;
}
</style>
</head>
<body>
<div id="map"></div>
<div id="status">Waiting for driver location‚Ä¶</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
let MAPBOX_TOKEN = "pk.eyJ1IjoiYWJoaXNoZWs2OSIsImEiOiJjbWo2MXBweGsxdGwzM2ZzYmlwMTBmeHV5In0.zuYgQ4F5JiCH6R6znK5T-w";
let map, driverMarker, routeLine;

const pickup = [27.7172, 85.3240]; // Kathmandu
const drop   = [27.7300, 85.3400];

function setMapboxToken(token) {
    MAPBOX_TOKEN = token;
}

function initMap() {
    map = L.map('map').setView(pickup, 14);

    L.tileLayer(
        `https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/{z}/{x}/{y}?access_token=${MAPBOX_TOKEN}`,
        {
            maxZoom: 19,
            tileSize: 512,
            zoomOffset: -1,
            attribution: "¬© OpenStreetMap ¬© Mapbox"
        }
    ).addTo(map);

    L.marker(pickup).addTo(map).bindPopup("Pickup Location üìç");
    L.marker(drop).addTo(map).bindPopup("Drop Location üéØ");

    driverMarker = L.marker(pickup).addTo(map).bindPopup("Driver üöï").openPopup();
    routeLine = L.polyline([pickup, drop], { color: "blue", weight: 4 }).addTo(map);

    document.getElementById("status").innerText = "Live tracking started";
}

function updateDriverLocation(lat, lng) {
    if (!driverMarker) return;
    driverMarker.setLatLng([lat, lng]);
    map.panTo([lat, lng], { animate: true });
    document.getElementById("status").innerText = `Driver at ${lat.toFixed(5)}, ${lng.toFixed(5)}`;
}

document.addEventListener('DOMContentLoaded', initMap);
</script>
</body>
</html>
